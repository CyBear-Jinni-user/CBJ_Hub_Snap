name: cbj-hub
base: core20
version: '0.1'
summary: Hub to control smart device from different vendors with one app.
description: |
  CyBear Jinni Hub to controll smart devices from different vendors with one easy to use app.
  It is open source Hub that keeps your data local by default.
  The Hub will extend the devices basic functionality by acting as a leader and sending signals
  to the devices acording to the logic you set it to be.
  The functionality will include activating routines, saving different scense, binding devices so
  that action in one device will triger other actions in different devices and more.

grade: stable  # devel/stable, must be 'stable' to release into candidate/stable channels
confinement: strict  # devmode/classic/strict, use 'strict' once you have the right plugs and slots


architectures:
  - build-on: armhf
    run-on: armhf

  - build-on: arm64
    run-on: arm64

  - build-on: amd64
    run-on: amd64

parts:
  scripts-files:
    plugin: dump
    source: .
    override-build: |
      rm README.md

  cbj-hub:
    after:
      - scripts-files
    plugin: dump
    source: https://github.com/CyBear-Jinni/cbj_hub.git
    override-build: |
      mv ../../scripts-files/src/scripts .
      scripts/bashScripts/nativeExecutableMaker.sh  # Downloading dart-sdk for the correct architecture.

      snapcraftctl build

    build-packages:
      - wget
      - unzip
      - gcc
      - g++
    stage-packages:
      - libatlas-base-dev
      - libevent-dev

apps:
  cbj-hub:
    command: CyBear-Jinni_Hub $SNAP
    daemon: simple
    plugs: [network, network-bind, hardware-observe, system-observe, avahi-control]

